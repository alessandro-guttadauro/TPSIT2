<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Esercizi Vue.js - Controllo Età, Carrello, Validazione, Salvataggio</title>
  <!-- Vue 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #fafafa;
    }
    .sezione {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      background-color: #fff;
    }
    input, textarea {
      padding: 5px;
      margin-top: 5px;
      width: 100%;
      box-sizing: border-box;
    }
    .errore {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- 1️⃣ Controllo Maggiore Età -->
    <div class="sezione">
      <h2>1. Controllo Maggiore Età</h2>
      <input type="number" v-model.number="eta" placeholder="Inserisci la tua età">
      <p><strong>{{ messaggioEta }}</strong></p>
    </div>

    <!-- 2️⃣ Carrello Semplice -->
    <div class="sezione">
      <h2>2. Carrello Semplice</h2>
      <ul>
        <li v-for="(p, index) in carrello" :key="index">{{ p.nome }} - €{{ p.prezzo.toFixed(2) }}</li>
      </ul>
      <p><strong>Totale carrello: €{{ totaleCarrello.toFixed(2) }}</strong></p>
    </div>

    <!-- 3️⃣ Validazione Input -->
    <div class="sezione">
      <h2>3. Validazione Username</h2>
      <input type="text" v-model="username" placeholder="Inserisci username">
      <p v-if="erroreUsername" class="errore">{{ erroreUsername }}</p>
    </div>

    <!-- 4️⃣ Salvataggio Automatico -->
    <div class="sezione">
      <h2>4. Salvataggio Automatico</h2>
      <textarea v-model="testo" rows="4" placeholder="Scrivi qualcosa..."></textarea>
      <p>{{ statoSalvataggio }}</p>
    </div>
  </div>

  <script>
    const { createApp, ref, computed, watch } = Vue

    createApp({
      setup() {
        // 1️⃣ Controllo Maggiore Età
        const eta = ref(0)
        const messaggioEta = computed(() => eta.value >= 18 ? 'Maggiorenne' : 'Minorenne')

        // 2️⃣ Carrello Semplice
        const carrello = ref([
          { nome: 'Pane', prezzo: 1.5 },
          { nome: 'Latte', prezzo: 2.2 },
          { nome: 'Pasta', prezzo: 1.8 }
        ])
        const totaleCarrello = computed(() =>
          carrello.value.reduce((somma, p) => somma + p.prezzo, 0)
        )

        // 3️⃣ Validazione Input
        const username = ref('')
        const erroreUsername = ref('')
        watch(username, (nuovoValore) => {
          if (nuovoValore.length > 0 && nuovoValore.length < 5) {
            erroreUsername.value = 'L’username deve contenere almeno 5 caratteri.'
          } else {
            erroreUsername.value = ''
          }
        })

        // 4️⃣ Salvataggio Automatico
        const testo = ref('')
        const statoSalvataggio = ref('')
        let timer = null

        watch(testo, () => {
          statoSalvataggio.value = 'Sto salvando...'
          clearTimeout(timer)
          timer = setTimeout(() => {
            statoSalvataggio.value = 'Salvato!'
          }, 1000)
        })

        return {
          eta,
          messaggioEta,
          carrello,
          totaleCarrello,
          username,
          erroreUsername,
          testo,
          statoSalvataggio
        }
      }
    }).mount('#app')
  </script>
</body>
</html>
